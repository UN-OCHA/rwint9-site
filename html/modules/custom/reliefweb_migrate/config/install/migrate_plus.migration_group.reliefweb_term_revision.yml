id: reliefweb_term_revision
label: ReliefWeb Migration - Term revisions
description: Migrate ReliefWeb term revisions from Drupal 7 to Drupal 9.
source_type: Drupal 7
shared_configuration:
  migration_tags:
    - taxonomy_term
    - taxonomy_term_revision
  dependencies:
    enforced:
      module:
        - reliefweb_migrate
  source:
    key: rwint7
    plugin: reliefweb_taxonomy_term_revision
    constants:
      format: markdown
    batch_size: 1000
    high_water_property:
      name: revision_id
      alias: tdr
  destination:
    plugin: reliefweb_entity_revision:taxonomy_term
  process:
    tid: tid
    vid:
      plugin: static_map
      source: vid
      map:
        career_categories: career_category
        content_format: content_format
        country: country
        disaster: disaster
        disaster_type: disaster_type
        feature: feature
        job_experience: job_experience
        job_type: job_type
        language: language
        ocha_product: ocha_product
        organization_type: organization_type
        source: source
        tags: tag
        theme: theme
        training_format: training_format
        training_type: training_type
        vulnerable_groups: vulnerable_group
    name: name
    description/value: description
    description/format: constants/format
    weight: weight
    changed: revision_created
    # Publication status.
    status:
      plugin: static_map
      source: field_status/0/value
      default_value: 0
      map:
        active: 1
        alert: 1
        current: 1
        inactive: 1
        normal: 1
        ongoing: 1
        past: 1
    # Moderation status.
    moderation_status:
      plugin: static_map
      source: field_status/0/value
      map:
        active: active
        alert: alert
        alert-archive: alert-archive
        archive: archive
        blocked: blocked
        draft: draft
        draft-archive: draft-archive
        duplicate: duplicate
        current: ongoing
        external: external
        external-archive: external-archive
        inactive: inactive
        normal: normal
        ongoing: ongoing
        past: past
    # Revision information.
    revision_id: revision_id
    revision_user:
      plugin: static_map
      bypass: true
      source: revision_user
      # Map the anonymous and super users to the System user.
      map:
        0: 2
        1: 2
    revision_log_message: revision_log_message
    revision_created:
      plugin: static_map
      bypass: true
      source: revision_created
      # Use the ReliefWeb creation date if we don't have a revision timestamp.
      map:
        0: 844128000
    revision_default: revision_default
    # Disable path alias generation.
    path/pathauto:
      plugin: default_value
      default_value: 0
    # Disable notifications.
    notifications_content_disable:
      plugin: default_value
      default_value: 1
    # Flag the entity as being migrated.
    _is_migrating:
      plugin: default_value
      default_value: 1
dependencies:
  enforced:
    module:
      - reliefweb_migrate
