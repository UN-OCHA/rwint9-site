{% set title_attributes = title_attributes.addClass('cd-block-title') %}

{{ attach_library('common_design/cd-block-title') }}
{{ attach_library('common_design_subtheme/rw-entity-description') }}

{% set description_attributes = description_attributes
  .setAttribute('id', id ~ '-content')
%}

{% include '@reliefweb_entities/reliefweb-entities-entity-description.html.twig' %}

<script>
  (function () {
    'use strict';

    // If there are more than 3 paragraphs/lists etc. in the overview, we only
    // display the last 3 ones and add a toggling button to show the full
    // overview.
    var overview = document.getElementById('{{ id }}-content');
    var children = overview.childNodes;
    var count = 0;
    for (var i = 0, l = children.length; i < l; i++) {
      if (children[i].nodeType === 1) {
        count++;
      }
    }
    if (count > 3) {
      overview.setAttribute('data-cd-toggable', 'Show full overview');
      overview.setAttribute('data-cd-label-switch', 'Hide full overview');
      overview.setAttribute('data-cd-toggable-keep', '');
    }
  })();
</script>
